<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='ç”µè„‘,ç”µè„‘è®²è§£,ç”µè„‘æŠ€æœ¯,ç¼–ç¨‹,ç”µè„‘æ•…éšœç»´ä¿®SpringBootå¼‚å¸¸å¤„ç†ç»Ÿä¸€å°è£…æˆ‘æ¥åš-ä½¿ç”¨ç¯‡' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>é¦–é¡µ</a></li>
</div><div onclick='hidden1()' >åˆ†äº«</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>SpringBootå¼‚å¸¸å¤„ç†ç»Ÿä¸€å°è£…æˆ‘æ¥åš-ä½¿ç”¨ç¯‡</center></div><div class='banquan'>åŸæ–‡å‡ºå¤„:æœ¬æ–‡ç”±åšå®¢å›­åšä¸»Purgeyaoæä¾›ã€‚<br/>
åŸæ–‡è¿æ¥:https://www.cnblogs.com/Purgeyao/p/11781408.html</div><br>
    <h1 id="springbootå¼‚å¸¸å¤„ç†ç»Ÿä¸€å°è£…æˆ‘æ¥åš-ä½¿ç”¨ç¯‡">SpringBootå¼‚å¸¸å¤„ç†ç»Ÿä¸€å°è£…æˆ‘æ¥åš-ä½¿ç”¨ç¯‡</h1>
<h2 id="ç®€ä»‹">ç®€ä»‹</h2>
<p>é‡å¤åŠŸèƒ½æˆ‘æ¥å†™ã€‚åœ¨ <code>SpringBoot</code> é¡¹ç›®é‡Œéƒ½æœ‰å…¨å±€å¼‚å¸¸å¤„ç†ä»¥åŠè¿”å›åŒ…è£…ç­‰ï¼Œè¿”å›å‰ç«¯æ˜¯å¸¦ä¸Š<code>succ</code>ã€<code>code</code>ã€<code>msg</code>ã€<code>data</code>ç­‰å­—æ®µã€‚å•ä¸ªé¡¹ç›®æƒ…å†µä¸‹å¾ˆå¥½è§£å†³ï¼Œå½“å¾®æœåŠ¡æ¨¡å—å¤šçš„æƒ…å†µä¸‹ï¼Œå¾ˆå¤šæƒ…å†µå¼€å‘éƒ½æ˜¯å¤åˆ¶åŸæœ‰ä»£ç è¿›è¡Œæ„å»ºå¦å¤–ä¸€ä¸ªé¡¹ç›®çš„ï¼Œå¯¼è‡´è¿™äº›åŠŸèƒ½å‡çº§éœ€è¦ä¿®æ”¹å¤šä¸ªæœåŠ¡ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å°è£…äº†ä¸€ä¸ªç»„ä»¶ <code>unified-dispose-springboot-starter</code> é‡Œé¢åŒ…å«äº†ä¸€äº›åŸºç¡€çš„å¼‚å¸¸å¤„ç†ä»¥åŠè¿”å›åŒ…è£…åŠŸèƒ½ã€‚</p>
<h2 id="ä¾èµ–æ·»åŠ å¯åŠ¨åŠŸèƒ½">ä¾èµ–æ·»åŠ å¯åŠ¨åŠŸèƒ½</h2>
<p>æ·»åŠ ä¾èµ–<br />
<strong>ps:</strong> å®é™…versionç‰ˆæœ¬è¯·ä½¿ç”¨æœ€æ–°ç‰ˆ<br />
<strong>æœ€æ–°ç‰ˆæœ¬:</strong> <a href="https://search.maven.org/search?q=g:com.purgeteam%20AND%20a:unified-dispose-springboot-starter"><embed src="https://img2018.cnblogs.com/blog/1766679/201911/1766679-20191102125719448-1961011435.svg+xml;charset=utf-8" /></a></p>
<p><a href="https://search.maven.org/search?q=g:com.purgeteam%20AND%20a:unified-dispose-springboot-starter">ç‚¹å‡»æŸ¥çœ‹æœ€æ–°æ–°ç‰ˆæœ¬</a></p>
<pre><code><code>&lt;dependency&gt;
  &lt;groupId&gt;com.purgeteam&lt;/groupId&gt;
  &lt;artifactId&gt;unified-dispose-springboot-starter&lt;/artifactId&gt;
  &lt;version&gt;0.1.1.RELEASE&lt;/version&gt;
&lt;/dependency&gt;</code></code></pre>
<p>å¯åŠ¨ç±»æ·»åŠ  <code>@EnableGlobalDispose</code> æ³¨è§£å¼€å¯ä»¥ä¸‹åŠŸèƒ½ã€‚</p>
<pre><code><code>@EnableGlobalDispose
@SpringBootApplication
public class GlobalDisposeSpringBootApplication {

  public static void main(String[] args) {
    SpringApplication.run(GlobalDisposeSpringBootApplication.class, args);
  }

}</code></code></pre>
<h2 id="one-å¼‚å¸¸å¤„ç†">One å¼‚å¸¸å¤„ç†âš ï¸</h2>
<p>åœ¨é¡¹ç›®ä¸­ç»å¸¸å‡ºç°ç³»ç»Ÿå¼‚å¸¸çš„æƒ…å†µï¼Œæ¯”å¦‚<code>NullPointerException</code>ç­‰ç­‰ã€‚å¦‚æœé»˜è®¤æœªå¤„ç†çš„æƒ…å†µä¸‹ï¼Œ<code>springboot</code>ä¼šå“åº”é»˜è®¤çš„é”™è¯¯æç¤ºï¼Œè¿™æ ·å¯¹ç”¨æˆ·ä½“éªŒä¸æ˜¯å‹å¥½ï¼Œç³»ç»Ÿå±‚é¢çš„é”™è¯¯ï¼Œç”¨æˆ·ä¸èƒ½æ„ŸçŸ¥åˆ°ï¼Œå³ä½¿ä¸º<code>500</code>çš„é”™è¯¯ï¼Œå¯ä»¥ç»™ç”¨æˆ·æç¤ºä¸€ä¸ªç±»ä¼¼<code>æœåŠ¡å™¨å¼€å°å·®</code>çš„å‹å¥½æç¤ºç­‰ã€‚</p>
<p>æ¨¡å—é‡Œä»¥åŠåŒ…å«äº†ä¸€äº›åŸºæœ¬çš„å¼‚å¸¸å¤„ç†æ–¹å¼(åŠä¸éœ€è¦åšä»»ä½•ä»£ç ç¼–å†™å·²ç»å…·æœ‰åŸºæœ¬å¼‚å¸¸å¤„ç†)ï¼Œä»¥åŠä¸€äº›å¸¸è§çš„å¼‚å¸¸codeï¼Œç”¨æˆ·åªéœ€è¦å…³å¿ƒä¸šåŠ¡å¼‚å¸¸å¤„ç†å³å¯ï¼Œç›´æ¥é€šè¿‡ <code>throw new å¼‚å¸¸</code> çš„æ–¹å¼æŠ›å‡ºå³å¯ã€‚</p>
<h3 id="å¼‚å¸¸å¤„ç†åŒ…å«ç±»å‹">å¼‚å¸¸å¤„ç†åŒ…å«ç±»å‹</h3>
<pre><code><code># é€šç”¨500å¼‚å¸¸
Exception ç±»æ•è· 500 å¼‚å¸¸å¤„ç†

# Feign å¼‚å¸¸
FeignException ç±»æ•è·
ClientException ç±»æ•è·

# ä¸šåŠ¡è‡ªå®šä¹‰
BusinessException ç±»æ•è· ä¸šåŠ¡é€šç”¨è‡ªå®šä¹‰å¼‚å¸¸

# å‚æ•°æ ¡éªŒå¼‚å¸¸
HttpMessageNotReadableException å‚æ•°é”™è¯¯å¼‚å¸¸
BindException å‚æ•°é”™è¯¯å¼‚å¸¸</code></code></pre>
<h3 id="ç¨‹åºä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸">ç¨‹åºä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸</h3>
<pre><code><code>throw new BusinessException(BusinessErrorCode.BUSINESS_ERROR);
// æˆ–è€…
throw new BusinessException(&quot;CLOUD800&quot;,&quot;æ²¡æœ‰å¤šä½™çš„åº“å­˜&quot;);</code></code></pre>
<p>é€šå¸¸ä¸å»ºè®®ç›´æ¥æŠ›å‡ºé€šç”¨çš„BusinessExceptionå¼‚å¸¸ï¼Œåº”å½“åœ¨å¯¹åº”çš„æ¨¡å—é‡Œæ·»åŠ å¯¹åº”çš„é¢†åŸŸçš„å¼‚å¸¸å¤„ç†ç±»ä»¥åŠå¯¹åº”çš„æšä¸¾é”™è¯¯ç±»å‹ã€‚</p>
<p>å¦‚ä¼šå‘˜æ¨¡å—ï¼š<br />
åˆ›å»º<code>UserException</code>å¼‚å¸¸ç±»ã€<code>UserErrorCode</code>æšä¸¾ã€ä»¥åŠ<code>UserExceptionHandler</code>ç»Ÿä¸€æ‹¦æˆªç±»ã€‚</p>
<p>UserException:</p>
<pre class="java"><code>@Data
public class UserException extends RuntimeException {

  private String code;
  private boolean isShowMsg = true;

  /**
   * ä½¿ç”¨æšä¸¾ä¼ å‚
   *
   * @param errorCode å¼‚å¸¸æšä¸¾
   */
  public UserException(UserErrorCode errorCode) {
    super(errorCode.getMessage());
    this.setCode(errorCode.getCode());
  }

}</code></code></pre>
<p>UserErrorCode:</p>
<pre class="java"><code>@Getter
public enum UserErrorCode {
    /**
     * æƒé™å¼‚å¸¸
     */
    NOT_PERMISSIONS(&quot;CLOUD401&quot;,&quot;æ‚¨æ²¡æœ‰æ“ä½œæƒé™&quot;),
    ;

    private String code;

    private String message;

    CommonErrorCode(String code, String message) {
        this.code = code;
        this.message = message;
    }
}</code></code></pre>
<p>UserExceptionHandler:</p>
<pre class="java"><code>@Slf4j
@RestControllerAdvice
public class UserExceptionHandler {

  /**
   * UserException ç±»æ•è·
   */
  @ExceptionHandler(value = UserException.class)
  public Result handler(UserException e) {
    log.error(e.getMessage(), e);
    return Result.ofFail(e.getCode(), e.getMessage());
  }

}</code></code></pre>
<p>æœ€åä¸šåŠ¡ä½¿ç”¨å¦‚ä¸‹ï¼š</p>
<pre class="java"><code>// åˆ¤æ–­æ˜¯å¦æœ‰æƒé™æŠ›å‡ºå¼‚å¸¸
throw new UserException(UserErrorCode.NOT_PERMISSIONS);</code></code></pre>
<p><strong>ä¸Šè¿°æ–¹å¼ï¼ŒæŠ›å‡ºå¼‚å¸¸åä¼šè¢«æ¨¡å—å¤„ç†ã€‚å‰å°è¿”å›å¦‚ä¸‹</strong>ï¼š</p>
<pre><code><code>{
  &quot;succ&quot;: false,        // æ˜¯å¦æˆåŠŸ
  &quot;ts&quot;: 1566467628851,  // æ—¶é—´æˆ³
  &quot;data&quot;: null,         // æ•°æ®
  &quot;code&quot;: &quot;CLOUD800&quot;,   // é”™è¯¯ç±»å‹
  &quot;msg&quot;: &quot;ä¸šåŠ¡å¼‚å¸¸&quot;,    // é”™è¯¯æè¿°
  &quot;fail&quot;: true
}</code></code></pre>
<h2 id="tow-ç»Ÿä¸€è¿”å›å°">Tow ç»Ÿä¸€è¿”å›å°ğŸ—³</h2>
<p>åœ¨RESTé£æ ¼çš„å¼€å‘ä¸­ï¼Œé¿å…é€šå¸¸ä¼šå‘ŠçŸ¥å‰å°è¿”å›æ˜¯å¦æˆåŠŸä»¥åŠçŠ¶æ€ç ç­‰ä¿¡æ¯ã€‚è¿™é‡Œæˆ‘ä»¬é€šå¸¸è¿”å›çš„æ—¶å€™åšä¸€æ¬¡<code>util</code>çš„åŒ…è£…å¤„ç†å·¥ä½œï¼Œå¦‚ï¼š<code>Result</code>ç±»ä¼¼çš„ç±»ï¼Œé‡Œé¢åŒ…å«<code>succ</code>ã€<code>code</code>ã€<code>msg</code>ã€<code>data</code>ç­‰å­—æ®µã€‚</p>
<p>æ¥å£è°ƒç”¨å¤„ç†ç±»ä¼¼å¦‚ä¸‹:</p>
<pre><code><code>  @GetMapping(&quot;hello&quot;)
  public Result list(){
    return Result.ofSuccess(&quot;hello&quot;);
  }</code></code></pre>
<p>ç»“æœ:</p>
<pre><code><code>{
  &quot;succ&quot;: ture,         // æ˜¯å¦æˆåŠŸ
  &quot;ts&quot;: 1566467628851,  // æ—¶é—´æˆ³
  &quot;data&quot;: &quot;hello&quot;,      // æ•°æ®
  &quot;code&quot;: null,         // é”™è¯¯ç±»å‹
  &quot;msg&quot;: null,          // é”™è¯¯æè¿°
  &quot;fail&quot;: true
}</code></code></pre>
<h3 id="åŠŸèƒ½ä½¿ç”¨">åŠŸèƒ½ä½¿ç”¨</h3>
<p>é»˜è®¤æƒ…å†µæ‰€æœ‰çš„ <code>web controller</code> éƒ½ä¼šè¢«å°è£…ä¸ºä¸€ä¸‹è¿”å›æ ¼å¼ã€‚</p>
<p>æ¥å£ï¼š</p>
<pre class="java"><code>@GetMapping(&quot;test&quot;)
public String test(){
  return &quot;test&quot;;
}</code></code></pre>
<p>è¿”å›</p>
<pre class="json"><code>{
  &quot;succ&quot;: true,             // æ˜¯å¦æˆåŠŸ
  &quot;ts&quot;: 1566386951005,      // æ—¶é—´æˆ³
  &quot;data&quot;: &quot;test&quot;,           // æ•°æ®
  &quot;code&quot;: null,             // é”™è¯¯ç±»å‹
  &quot;msg&quot;: null,              // é”™è¯¯æè¿°
  &quot;fail&quot;: false             
}</code></code></pre>
<h3 id="å¿½ç•¥å°è£…æ³¨è§£ignorreponseadvice">å¿½ç•¥å°è£…æ³¨è§£:@IgnorReponseAdvice</h3>
<p><code>@IgnorReponseAdvice</code>å…è®¸èŒƒå›´ä¸ºï¼š<strong>ç±» + æ–¹æ³•</strong>ï¼Œæ ‡è¯†åœ¨ç±»ä¸Šè¿™ä¸ªç±»ä¸‹çš„è¯´æœ‰æ–¹æ³•çš„è¿”å›éƒ½å°†å¿½ç•¥è¿”å›å°è£…ã€‚</p>
<p>æ¥å£ï¼š</p>
<pre class="java"><code>@IgnorReponseAdvice // å¿½ç•¥æ•°æ®åŒ…è£… å¯æ·»åŠ åˆ°ç±»ã€æ–¹æ³•ä¸Š
@GetMapping(&quot;test&quot;)
public String test(){
  return &quot;test&quot;;
}</code></code></pre>
<p>è¿”å› <code>test</code></p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>é¡¹ç›®é‡Œå¾ˆå¤šé‡å¤çš„codeï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€å®šçš„æ–¹å¼å»ç®€åŒ–ï¼Œä»¥è¾¾åˆ°ä¸€å®šç›®çš„å‡å°‘å¼€å‘é‡ã€‚PurgeTeam å…·æœ‰ä¸€äº›ä¼˜ç§€çš„å¼€æºç»„ä»¶ï¼Œå‡å°‘æ—¥å¸¸çš„å¼€å‘é‡ã€‚</p>
<blockquote>
<p>ç¤ºä¾‹ä»£ç åœ°å€:<a href="https://github.com/purgeteam/unified-dispose-springboot">unified-dispose-springboot</a></p>
</blockquote>
<blockquote>
<p>ä½œè€…GitHub:<br />
<a href="https://github.com/purgeyao">Purgeyao</a> æ¬¢è¿å…³æ³¨</p>
</blockquote>
<blockquote>
<p>qqäº¤æµç¾¤: <code>812321371</code> å¾®ä¿¡äº¤æµç¾¤: <code>MercyYao</code></p>
</blockquote>
<blockquote>
<p>å¾®ä¿¡å…¬ä¼—å·:</p>
</blockquote>
<p><img src="./images/SpringBootå¼‚å¸¸å¤„ç†ç»Ÿä¸€å°è£…æˆ‘æ¥åš-ä½¿ç”¨ç¯‡0.png" alt="å¾®ä¿¡å…¬ä¼—å·äºŒç»´ç " /></p>


</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>